(function(a){if(typeof a.fn.each2=="undefined"){a.fn.extend({each2:function(f){var d=a([0]),e=-1,b=this.length;while(++e<b&&(d.context=d[0]=this[e])&&f.call(d[0],e,d)!==false){}return this}})}})(jQuery);(function(j,l){if(window.Select2!==l){return}var c,e,v,E,t,a,A,B;c={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(F){F=F.which?F.which:F;switch(F){case c.LEFT:case c.RIGHT:case c.UP:case c.DOWN:return true}return false},isControl:function(G){var F=G.which;switch(F){case c.SHIFT:case c.CTRL:case c.ALT:return true}if(G.metaKey){return true}return false},isFunctionKey:function(F){F=F.which?F.which:F;return F>=112&&F<=123}};B=j(document);t=(function(){var F=1;return function(){return F++}}());function b(I,J){var H=0,F=J.length,G;if(typeof I==="undefined"){return -1}if(I.constructor===String){for(;H<F;H=H+1){if(I.localeCompare(J[H])===0){return H}}}else{for(;H<F;H=H+1){G=J[H];if(G.constructor===String){if(G.localeCompare(I)===0){return H}}else{if(G===I){return H}}}}return -1}function q(G,F){if(G===F){return true}if(G===l||F===l){return false}if(G===null||F===null){return false}if(G.constructor===String){return G.localeCompare(F)===0}if(F.constructor===String){return F.localeCompare(G)===0}return false}function m(G,I){var J,H,F;if(G===null||G.length<1){return[]}J=G.split(I);for(H=0,F=J.length;H<F;H=H+1){J[H]=j.trim(J[H])}return J}function n(F){return F.outerWidth(false)-F.width()}function z(G){var F="keyup-change-value";G.bind("keydown",function(){if(j.data(G,F)===l){j.data(G,F,G.val())}});G.bind("keyup",function(){var H=j.data(G,F);if(H!==l&&G.val()!==H){j.removeData(G,F);G.trigger("keyup-change")}})}B.bind("mousemove",function(F){A={x:F.pageX,y:F.pageY}});function u(F){F.bind("mousemove",function(H){var G=A;if(G===l||G.x!==H.pageX||G.y!==H.pageY){j(H.target).trigger("mousemove-filtered",H)}})}function g(I,G,F){F=F||l;var H;return function(){var J=arguments;window.clearTimeout(H);H=window.setTimeout(function(){G.apply(F,J)},I)}}function C(H){var F=false,G;return function(){if(F===false){G=H();F=true}return G}}function f(F,H){var G=g(F,function(I){H.trigger("scroll-debounced",I)});H.bind("scroll",function(I){if(b(I.target,H.get())>=0){G(I)}})}function d(F){F.preventDefault();F.stopPropagation()}function D(F){F.preventDefault();F.stopImmediatePropagation()}function x(G){if(!a){var F=G[0].currentStyle||window.getComputedStyle(G[0],null);a=j("<div></div>").css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:F.fontSize,fontFamily:F.fontFamily,fontStyle:F.fontStyle,fontWeight:F.fontWeight,letterSpacing:F.letterSpacing,textTransform:F.textTransform,whiteSpace:"nowrap"});j("body").append(a)}a.text(G.val());return a.width()}function i(J,I,G){var H=J.toUpperCase().indexOf(I.toUpperCase()),F=I.length;if(H<0){G.push(J);return}G.push(J.substring(0,H));G.push("<span class='select2-match'>");G.push(J.substring(H,H+F));G.push("</span>");G.push(J.substring(H+F,J.length))}function p(G){var I,F=0,H=null,J=G.quietMillis||100;return function(K){window.clearTimeout(I);I=window.setTimeout(function(){F+=1;var L=F,O=G.data,P=G.transport||j.ajax,N=G.traditional||false,M=G.type||"GET";O=O.call(this,K.term,K.page,K.context);if(null!==H){H.abort()}H=P.call(null,{url:G.url,dataType:G.dataType,data:O,type:M,traditional:N,success:function(R){if(L<F){return}var Q=G.results(R,K.page);K.callback(Q)}})},J)}}function r(F){var H=F,G,I=function(J){return""+J.text};if(!j.isArray(H)){I=H.text;if(!j.isFunction(I)){G=H.text;I=function(J){return J[G]}}H=H.results}return function(L){var K=L.term,J={results:[]},M;if(K===""){L.callback({results:H});return}M=function(O,Q){var P,N;O=O[0];if(O.children){P={};for(N in O){if(O.hasOwnProperty(N)){P[N]=O[N]}}P.children=[];j(O.children).each2(function(R,S){M(S,P.children)});if(P.children.length||L.matcher(K,I(P))){Q.push(P)}}else{if(L.matcher(K,I(O))){Q.push(O)}}};j(H).each2(function(O,N){M(N,J.results)});L.callback(J)}}function o(F){if(j.isFunction(F)){return F}return function(I){var H=I.term,G={results:[]};j(F).each(function(){var J=this.text!==l,K=J?this.text:this;if(H===""||I.matcher(H,K)){G.results.push(J?this:{id:this,text:this})}});I.callback(G)}}function k(F,G){if(j.isFunction(F)){return true}if(!F){return false}throw new Error("formatterName must be a function or a falsy value")}function s(F){return j.isFunction(F)?F():F}function h(F){var G=0;j.each(F,function(H,I){if(I.children){G+=h(I.children)}else{G++}});return G}function y(N,O,L,F){var G=N,P=false,I,M,J,H,K;if(!F.createSearchChoice||!F.tokenSeparators||F.tokenSeparators.length<1){return l}while(true){M=-1;for(J=0,H=F.tokenSeparators.length;J<H;J++){K=F.tokenSeparators[J];M=N.indexOf(K);if(M>=0){break}}if(M<0){break}I=N.substring(0,M);N=N.substring(M+K.length);if(I.length>0){I=F.createSearchChoice(I,O);if(I!==l&&I!==null&&F.id(I)!==l&&F.id(I)!==null){P=false;for(J=0,H=O.length;J<H;J++){if(q(F.id(I),F.id(O[J]))){P=true;break}}if(!P){L(I)}}}}if(G.localeCompare(N)!=0){return N}}B.ready(function(){B.bind("mousedown touchend",function(H){var G=j(H.target).closest("div.select2-container").get(0),F;if(G){B.find("div.select2-container-active").each(function(){if(this!==G){j(this).data("select2").blur()}})}else{G=j(H.target).closest("div.select2-drop").get(0);B.find("div.select2-drop-active").each(function(){if(this!==G){j(this).data("select2").blur()}})}G=j(H.target);F=G.attr("for");if("LABEL"===H.target.tagName&&F&&F.length>0){F=F.replace(/([\[\].])/g,"\\$1");G=j("#"+F);G=G.data("select2");if(G!==l){G.focus();H.preventDefault()}}})});function w(F,G){var H=function(){};H.prototype=new F;H.prototype.constructor=H;H.prototype.parent=F.prototype;H.prototype=j.extend(H.prototype,G);return H}e=w(Object,{bind:function(G){var F=this;return function(){G.apply(F,arguments)}},init:function(H){var G,F,I=".select2-results";this.opts=H=this.prepareOpts(H);this.id=H.id;if(H.element.data("select2")!==l&&H.element.data("select2")!==null){this.destroy()}this.enabled=true;this.container=this.createContainer();this.containerId="s2id_"+(H.element.attr("id")||"autogen"+t());this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1");this.container.attr("id",this.containerId);this.body=C(function(){return H.element.closest("body")});if(H.element.attr("class")!==l){this.container.addClass(H.element.attr("class").replace(/validate\[[\S ]+] ?/,""))}this.container.css(s(H.containerCss));this.container.addClass(s(H.containerCssClass));this.opts.element.data("select2",this).hide().before(this.container);this.container.data("select2",this);this.dropdown=this.container.find(".select2-drop");this.dropdown.addClass(s(H.dropdownCssClass));this.dropdown.data("select2",this);this.results=G=this.container.find(I);this.search=F=this.container.find("input.select2-input");F.attr("tabIndex",this.opts.element.attr("tabIndex"));this.resultsPage=0;this.context=null;this.initContainer();this.initContainerWidth();u(this.results);this.dropdown.delegate(I,"mousemove-filtered",this.bind(this.highlightUnderEvent));f(80,this.results);this.dropdown.delegate(I,"scroll-debounced",this.bind(this.loadMoreIfNeeded));if(j.fn.mousewheel){G.mousewheel(function(N,O,L,K){var M=G.scrollTop(),J;if(K>0&&M-K<=0){G.scrollTop(0);d(N)}else{if(K<0&&G.get(0).scrollHeight-G.scrollTop()+K<=G.height()){G.scrollTop(G.get(0).scrollHeight-G.height());d(N)}}})}z(F);F.bind("keyup-change",this.bind(this.updateResults));F.bind("focus",function(){F.addClass("select2-focused");if(F.val()===" "){F.val("")}});F.bind("blur",function(){F.removeClass("select2-focused")});this.dropdown.delegate(I,"mouseup",this.bind(function(J){if(j(J.target).closest(".select2-result-selectable:not(.select2-disabled)").length>0){this.highlightUnderEvent(J);this.selectHighlighted(J)}else{this.focusSearch()}d(J)}));this.dropdown.bind("click mouseup mousedown",function(J){J.stopPropagation()});if(j.isFunction(this.opts.initSelection)){this.initSelection();this.monitorSource()}if(H.element.is(":disabled")||H.element.is("[readonly='readonly']")){this.disable()}},destroy:function(){var F=this.opts.element.data("select2");if(F!==l){F.container.remove();F.dropdown.remove();F.opts.element.removeData("select2").unbind(".select2").show()}},prepareOpts:function(J){var H,G,F,I;H=J.element;if(H.get(0).tagName.toLowerCase()==="select"){this.select=G=J.element}if(G){j.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in J){throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}})}J=j.extend({},{populateResults:function(K,O,Q){var P,N,S,M,L=this.opts.id,R=this;P=function(Y,T,X){var Z,V,ae,ab,ad,U,ac,aa,W;for(Z=0,V=Y.length;Z<V;Z=Z+1){ae=Y[Z];ab=L(ae)!==l;ad=ae.children&&ae.children.length>0;U=j("<li></li>");U.addClass("select2-results-dept-"+X);U.addClass("select2-result");U.addClass(ab?"select2-result-selectable":"select2-result-unselectable");if(ad){U.addClass("select2-result-with-children")}U.addClass(R.opts.formatResultCssClass(ae));ac=j("<div></div>");ac.addClass("select2-result-label");W=J.formatResult(ae,ac,Q);if(W!==l){ac.html(R.opts.escapeMarkup(W))}U.append(ac);if(ad){aa=j("<ul></ul>");aa.addClass("select2-result-sub");P(ae.children,aa,X+1);U.append(aa)}U.data("select2-data",ae);T.append(U)}};P(O,K,0)}},j.fn.select2.defaults,J);if(typeof(J.id)!=="function"){F=J.id;J.id=function(K){return K[F]}}if(G){J.query=this.bind(function(N){var M={results:[],more:false},L=N.term,K,P,O;O=function(Q,S){var R;if(Q.is("option")){if(N.matcher(L,Q.text(),Q)){S.push({id:Q.attr("value"),text:Q.text(),element:Q.get(),css:Q.attr("class")})}}else{if(Q.is("optgroup")){R={text:Q.attr("label"),children:[],element:Q.get(),css:Q.attr("class")};Q.children().each2(function(T,U){O(U,R.children)});if(R.children.length>0){S.push(R)}}}};K=H.children();if(this.getPlaceholder()!==l&&K.length>0){P=K[0];if(j(P).text()===""){K=K.not(P)}}K.each2(function(Q,R){O(R,M.results)});N.callback(M)});J.id=function(K){return K.id};J.formatResultCssClass=function(K){return K.css}}else{if(!("query" in J)){if("ajax" in J){I=J.element.data("ajax-url");if(I&&I.length>0){J.ajax.url=I}J.query=p(J.ajax)}else{if("data" in J){J.query=r(J.data)}else{if("tags" in J){J.query=o(J.tags);J.createSearchChoice=function(K){return{id:K,text:K}};J.initSelection=function(K,M){var L=[];j(m(K.val(),J.separator)).each(function(){var P=this,O=this,N=J.tags;if(j.isFunction(N)){N=N()}j(N).each(function(){if(q(this.id,P)){O=this.text;return false}});L.push({id:P,text:O})});M(L)}}}}}}if(typeof(J.query)!=="function"){throw"query function not defined for Select2 "+J.element.attr("id")}return J},monitorSource:function(){this.opts.element.bind("change.select2",this.bind(function(F){if(this.opts.element.data("select2-change-triggered")!==true){this.initSelection()}}))},triggerChange:function(F){F=F||{};F=j.extend({},F,{type:"change",val:this.val()});this.opts.element.data("select2-change-triggered",true);this.opts.element.trigger(F);this.opts.element.data("select2-change-triggered",false);this.opts.element.click();if(this.opts.blurOnChange){this.opts.element.blur()}},enable:function(){if(this.enabled){return}this.enabled=true;this.container.removeClass("select2-container-disabled");this.opts.element.removeAttr("disabled")},disable:function(){if(!this.enabled){return}this.close();this.enabled=false;this.container.addClass("select2-container-disabled");this.opts.element.attr("disabled","disabled")},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var J=this.container.offset(),R=this.container.outerHeight(false),G=this.container.outerWidth(false),I=this.dropdown.outerHeight(false),N=j(window).scrollTop()+document.documentElement.clientHeight,F=J.top+R,Q=J.left,O=F+I<=N,M=(J.top-I)>=this.body().scrollTop(),H=this.dropdown.hasClass("select2-drop-above"),K,P,L;if(this.body().css("position")!=="static"){K=this.body().offset();F-=K.top;Q-=K.left}if(H){P=true;if(!M&&O){P=false}}else{P=false;if(!O&&M){P=true}}if(P){F=J.top-I;this.container.addClass("select2-drop-above");this.dropdown.addClass("select2-drop-above")}else{this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above")}L=j.extend({top:F,left:Q,width:G},s(this.opts.dropdownCss));this.dropdown.css(L)},shouldOpen:function(){var F;if(this.opened()){return false}F=j.Event("open");this.opts.element.trigger(F);return !F.isDefaultPrevented()},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above");this.dropdown.removeClass("select2-drop-above")},open:function(){if(!this.shouldOpen()){return false}window.setTimeout(this.bind(this.opening),1);return true},opening:function(){var I=this.containerId,G=this.containerSelector,F="scroll."+I,H="resize."+I;this.container.parents().each(function(){j(this).bind(F,function(){var J=j(G);if(J.length==0){j(this).unbind(F)}J.select2("close")})});window.setTimeout(function(){j(window).bind(H,function(){var J=j(G);if(J.length==0){j(window).unbind(H)}J.select2("close")})},10);this.clearDropdownAlignmentPreference();if(this.search.val()===" "){this.search.val("")}this.container.addClass("select2-dropdown-open").addClass("select2-container-active");this.updateResults(true);if(this.dropdown[0]!==this.body().children().last()[0]){this.dropdown.detach().appendTo(this.body())}this.dropdown.show();this.positionDropdown();this.dropdown.addClass("select2-drop-active");this.ensureHighlightVisible();this.focusSearch()},close:function(){if(!this.opened()){return}var F=this;this.container.parents().each(function(){j(this).unbind("scroll."+F.containerId)});j(window).unbind("resize."+this.containerId);this.clearDropdownAlignmentPreference();this.dropdown.hide();this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active");this.results.empty();this.clearSearch();this.opts.element.trigger(j.Event("close"))},clearSearch:function(){},ensureHighlightVisible:function(){var I=this.results,H,F,M,L,J,K,G;F=this.highlight();if(F<0){return}if(F==0){I.scrollTop(0);return}H=I.find(".select2-result-selectable");M=j(H[F]);L=M.offset().top+M.outerHeight(true);if(F===H.length-1){G=I.find("li.select2-more-results");if(G.length>0){L=G.offset().top+G.outerHeight(true)}}J=I.offset().top+I.outerHeight(true);if(L>J){I.scrollTop(I.scrollTop()+(L-J))}K=M.offset().top-I.offset().top;if(K<0&&M.css("display")!="none"){I.scrollTop(I.scrollTop()+K)}},moveHighlight:function(I){var H=this.results.find(".select2-result-selectable"),G=this.highlight();while(G>-1&&G<H.length){G+=I;var F=j(H[G]);if(F.hasClass("select2-result-selectable")&&!F.hasClass("select2-disabled")){this.highlight(G);break}}},highlight:function(F){var G=this.results.find(".select2-result-selectable").not(".select2-disabled");if(arguments.length===0){return b(G.filter(".select2-highlighted")[0],G.get())}if(F>=G.length){F=G.length-1}if(F<0){F=0}G.removeClass("select2-highlighted");j(G[F]).addClass("select2-highlighted");this.ensureHighlightVisible()},countSelectableResults:function(){return this.results.find(".select2-result-selectable").not(".select2-disabled").length},highlightUnderEvent:function(G){var F=j(G.target).closest(".select2-result-selectable");if(F.length>0&&!F.is(".select2-highlighted")){var H=this.results.find(".select2-result-selectable");this.highlight(H.index(F))}else{if(F.length==0){this.results.find(".select2-highlighted").removeClass("select2-highlighted")}}},loadMoreIfNeeded:function(){var J=this.results,I=J.find("li.select2-more-results"),M,L=-1,K=this.resultsPage+1,F=this,H=this.search.val(),G=this.context;if(I.length===0){return}M=I.offset().top-J.offset().top-J.height();if(M<=0){I.addClass("select2-active");this.opts.query({term:H,page:K,context:G,matcher:this.opts.matcher,callback:this.bind(function(N){if(!F.opened()){return}F.opts.populateResults.call(this,J,N.results,{term:H,page:K,context:G});if(N.more===true){I.detach().appendTo(J).text(F.opts.formatLoadMore(K+1));window.setTimeout(function(){F.loadMoreIfNeeded()},10)}else{I.remove()}F.positionDropdown();F.resultsPage=K})})}},tokenize:function(){},updateResults:function(K){var N=this.search,I=this.results,F=this.opts,H,M=this,L;if(K!==true&&(this.showSearchInput===false||!this.opened())){return}N.addClass("select2-active");function J(){I.scrollTop(0);N.removeClass("select2-active");M.positionDropdown()}function G(O){I.html(M.opts.escapeMarkup(O));J()}if(F.maximumSelectionSize>=1){H=this.data();if(j.isArray(H)&&H.length>=F.maximumSelectionSize&&k(F.formatSelectionTooBig,"formatSelectionTooBig")){G("<li class='select2-selection-limit'>"+F.formatSelectionTooBig(F.maximumSelectionSize)+"</li>");return}}if(N.val().length<F.minimumInputLength){if(k(F.formatInputTooShort,"formatInputTooShort")){G("<li class='select2-no-results'>"+F.formatInputTooShort(N.val(),F.minimumInputLength)+"</li>")}else{G("")}return}else{if(F.formatSearching()){G("<li class='select2-searching'>"+F.formatSearching()+"</li>")}}L=this.tokenize();if(L!=l&&L!=null){N.val(L)}this.resultsPage=1;F.query({term:N.val(),page:this.resultsPage,context:null,matcher:F.matcher,callback:this.bind(function(P){var O;if(!this.opened()){return}this.context=(P.context===l)?null:P.context;if(this.opts.createSearchChoice&&N.val()!==""){O=this.opts.createSearchChoice.call(null,N.val(),P.results);if(O!==l&&O!==null&&M.id(O)!==l&&M.id(O)!==null){if(j(P.results).filter(function(){return q(M.id(this),M.id(O))}).length===0){P.results.unshift(O)}}}if(P.results.length===0&&k(F.formatNoMatches,"formatNoMatches")){G("<li class='select2-no-results'>"+F.formatNoMatches(N.val())+"</li>");return}I.empty();M.opts.populateResults.call(this,I,P.results,{term:N.val(),page:this.resultsPage,context:null});if(P.more===true&&k(F.formatLoadMore,"formatLoadMore")){I.append("<li class='select2-more-results'>"+M.opts.escapeMarkup(F.formatLoadMore(this.resultsPage))+"</li>");window.setTimeout(function(){M.loadMoreIfNeeded()},10)}this.postprocessResults(P,K);J()})})},cancel:function(){this.close()},blur:function(){this.close();this.container.removeClass("select2-container-active");this.dropdown.removeClass("select2-drop-active");if(this.search[0]===document.activeElement){this.search.blur()}this.clearSearch();this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");this.opts.element.triggerHandler("blur")},focusSearch:function(){this.search.show();this.search.focus();window.setTimeout(this.bind(function(){this.search.show();this.search.focus();this.search.val(this.search.val())}),10)},selectHighlighted:function(){var F=this.highlight(),G=this.results.find(".select2-highlighted").not(".select2-disabled"),H=G.closest(".select2-result-selectable").data("select2-data");if(H){G.addClass("select2-disabled");this.highlight(F);this.onSelect(H)}},getPlaceholder:function(){return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder},initContainerWidth:function(){function G(){var K,I,L,J,H;if(this.opts.width==="off"){return null}else{if(this.opts.width==="element"){return this.opts.element.outerWidth(false)===0?"auto":this.opts.element.outerWidth(false)+"px"}else{if(this.opts.width==="copy"||this.opts.width==="resolve"){K=this.opts.element.attr("style");if(K!==l){I=K.split(";");for(J=0,H=I.length;J<H;J=J+1){L=I[J].replace(/\s/g,"").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/);if(L!==null&&L.length>=1){return L[1]}}}if(this.opts.width==="resolve"){K=this.opts.element.css("width");if(K.indexOf("%")>0){return K}return(this.opts.element.outerWidth(false)===0?"auto":this.opts.element.outerWidth(false)+"px")}return null}else{if(j.isFunction(this.opts.width)){return this.opts.width()}else{return this.opts.width}}}}}var F=G.call(this);if(F!==null){this.container.attr("style","width: "+F)}}});v=w(e,{createContainer:function(){var F=j("<div></div>",{"class":"select2-container"}).html(["    <a href='javascript:void(0)' onclick='return false;' class='select2-choice'>","   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>","   <div><b></b></div>","</a>","    <div class='select2-drop select2-offscreen'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return F},opening:function(){this.search.show();this.parent.opening.apply(this,arguments);this.dropdown.removeClass("select2-offscreen")},close:function(){if(!this.opened()){return}this.parent.close.apply(this,arguments);this.dropdown.removeAttr("style").addClass("select2-offscreen").insertAfter(this.selection).show()},focus:function(){this.close();this.selection.focus()},isFocused:function(){return this.selection[0]===document.activeElement},cancel:function(){this.parent.cancel.apply(this,arguments);this.selection.focus()},initContainer:function(){var H,G=this.container,I=this.dropdown,F=false;this.selection=H=G.find(".select2-choice");this.search.bind("keydown",this.bind(function(J){if(!this.enabled){return}if(J.which===c.PAGE_UP||J.which===c.PAGE_DOWN){d(J);return}if(this.opened()){switch(J.which){case c.UP:case c.DOWN:this.moveHighlight((J.which===c.UP)?-1:1);d(J);return;case c.TAB:case c.ENTER:this.selectHighlighted();d(J);return;case c.ESC:this.cancel(J);d(J);return}}else{if(J.which===c.TAB||c.isControl(J)||c.isFunctionKey(J)||J.which===c.ESC){return}if(this.opts.openOnEnter===false&&J.which===c.ENTER){return}this.open();if(J.which===c.ENTER){return}}}));this.search.bind("focus",this.bind(function(){this.selection.attr("tabIndex","-1")}));this.search.bind("blur",this.bind(function(){if(!this.opened()){this.container.removeClass("select2-container-active")}window.setTimeout(this.bind(function(){var J=this.opts.element.attr("tabIndex");if(J){this.selection.attr("tabIndex",J)}else{this.selection.removeAttr("tabIndex")}}),10)}));H.delegate("abbr","mousedown",this.bind(function(J){if(!this.enabled){return}this.clear();D(J);this.close();this.triggerChange();this.selection.focus()}));H.bind("mousedown",this.bind(function(J){F=true;if(this.opened()){this.close();this.selection.focus()}else{if(this.enabled){this.open()}}F=false}));I.bind("mousedown",this.bind(function(){this.search.focus()}));H.bind("focus",this.bind(function(){this.container.addClass("select2-container-active");this.search.attr("tabIndex","-1")}));H.bind("blur",this.bind(function(){if(!this.opened()){this.container.removeClass("select2-container-active")}window.setTimeout(this.bind(function(){this.search.attr("tabIndex",this.opts.element.attr("tabIndex"))}),10)}));H.bind("keydown",this.bind(function(J){if(!this.enabled){return}if(J.which==c.DOWN||J.which==c.UP||(J.which==c.ENTER&&this.opts.openOnEnter)){this.open();d(J);return}if(J.which==c.DELETE||J.which==c.BACKSPACE){if(this.opts.allowClear){this.clear()}d(J);return}}));H.bind("keypress",this.bind(function(K){var J=String.fromCharCode(K.which);this.search.val(J);this.open()}));this.setPlaceholder();this.search.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")}))},clear:function(){this.opts.element.val("");this.selection.find("span").empty();this.selection.removeData("select2-data");this.setPlaceholder()},initSelection:function(){var G;if(this.opts.element.val()===""&&this.opts.element.text()===""){this.close();this.setPlaceholder()}else{var F=this;this.opts.initSelection.call(null,this.opts.element,function(H){if(H!==l&&H!==null){F.updateSelection(H);F.close();F.setPlaceholder()}})}},prepareOpts:function(){var F=this.parent.prepareOpts.apply(this,arguments);if(F.element.get(0).tagName.toLowerCase()==="select"){F.initSelection=function(G,I){var H=G.find(":selected");if(j.isFunction(I)){I({id:H.attr("value"),text:H.text(),element:H})}}}return F},setPlaceholder:function(){var F=this.getPlaceholder();if(this.opts.element.val()===""&&F!==l){if(this.select&&this.select.find("option:first").text()!==""){return}this.selection.find("span").html(this.opts.escapeMarkup(F));this.selection.addClass("select2-default");this.selection.find("abbr").hide()}},postprocessResults:function(I,G){var H=0,F=this,J=true;this.results.find(".select2-result-selectable").each2(function(K,L){if(q(F.id(L.data("select2-data")),F.opts.element.val())){H=K;return false}});this.highlight(H);if(G===true){J=this.showSearchInput=h(I.results)>=this.opts.minimumResultsForSearch;this.dropdown.find(".select2-search")[J?"removeClass":"addClass"]("select2-search-hidden");j(this.dropdown,this.container)[J?"addClass":"removeClass"]("select2-with-searchbox")}},onSelect:function(G){var F=this.opts.element.val();this.opts.element.val(this.id(G));this.updateSelection(G);this.close();this.selection.focus();if(!q(F,this.id(G))){this.triggerChange()}},updateSelection:function(H){var F=this.selection.find("span"),G;this.selection.data("select2-data",H);F.empty();G=this.opts.formatSelection(H,F);if(G!==l){F.append(this.opts.escapeMarkup(G))}this.selection.removeClass("select2-default");if(this.opts.allowClear&&this.getPlaceholder()!==l){this.selection.find("abbr").show()}},val:function(){var H,G=null,F=this;if(arguments.length===0){return this.opts.element.val()}H=arguments[0];if(this.select){this.select.val(H).find(":selected").each2(function(I,J){G={id:J.attr("value"),text:J.text()};return false});this.updateSelection(G);this.setPlaceholder()}else{if(this.opts.initSelection===l){throw new Error("cannot call val() if initSelection() is not defined")}if(!H){this.clear();return}this.opts.element.val(H);this.opts.initSelection(this.opts.element,function(I){F.opts.element.val(!I?"":F.id(I));F.updateSelection(I);F.setPlaceholder()})}},clearSearch:function(){this.search.val("")},data:function(G){var F;if(arguments.length===0){F=this.selection.data("select2-data");if(F==l){F=null}return F}else{if(!G||G===""){this.clear()}else{this.opts.element.val(!G?"":this.id(G));this.updateSelection(G)}}}});E=w(e,{createContainer:function(){var F=j("<div></div>",{"class":"select2-container select2-container-multi"}).html(["    <ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi' style='display:none;'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return F},prepareOpts:function(){var F=this.parent.prepareOpts.apply(this,arguments);if(F.element.get(0).tagName.toLowerCase()==="select"){F.initSelection=function(G,I){var H=[];G.find(":selected").each2(function(J,K){H.push({id:K.attr("value"),text:K.text(),element:K})});if(j.isFunction(I)){I(H)}}}return F},initContainer:function(){var F=".select2-choices",G;this.searchContainer=this.container.find(".select2-search-field");this.selection=G=this.container.find(F);this.search.bind("keydown",this.bind(function(I){if(!this.enabled){return}if(I.which===c.BACKSPACE&&this.search.val()===""){this.close();var J,H=G.find(".select2-search-choice-focus");if(H.length>0){this.unselect(H.first());this.search.width(10);d(I);return}J=G.find(".select2-search-choice:not(.select2-locked)");if(J.length>0){J.last().addClass("select2-search-choice-focus")}}else{G.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")}if(this.opened()){switch(I.which){case c.UP:case c.DOWN:this.moveHighlight((I.which===c.UP)?-1:1);d(I);return;case c.ENTER:case c.TAB:this.selectHighlighted();d(I);return;case c.ESC:this.cancel(I);d(I);return}}if(I.which===c.TAB||c.isControl(I)||c.isFunctionKey(I)||I.which===c.BACKSPACE||I.which===c.ESC){return}if(this.opts.openOnEnter===false&&I.which===c.ENTER){return}this.open();if(I.which===c.PAGE_UP||I.which===c.PAGE_DOWN){d(I)}}));this.search.bind("keyup",this.bind(this.resizeSearch));this.search.bind("blur",this.bind(function(H){this.container.removeClass("select2-container-active");this.search.removeClass("select2-focused");this.clearSearch();H.stopImmediatePropagation()}));this.container.delegate(F,"mousedown",this.bind(function(H){if(!this.enabled){return}if(j(H.target).closest(".select2-search-choice").length>0){return}this.clearPlaceholder();this.open();this.focusSearch();H.preventDefault()}));this.container.delegate(F,"focus",this.bind(function(){if(!this.enabled){return}this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active");this.clearPlaceholder()}));this.clearSearch()},enable:function(){if(this.enabled){return}this.parent.enable.apply(this,arguments);this.search.removeAttr("disabled")},disable:function(){if(!this.enabled){return}this.parent.disable.apply(this,arguments);this.search.attr("disabled",true)},initSelection:function(){var G;if(this.opts.element.val()===""&&this.opts.element.text()===""){this.updateSelection([]);this.close();this.clearSearch()}if(this.select||this.opts.element.val()!==""){var F=this;this.opts.initSelection.call(null,this.opts.element,function(H){if(H!==l&&H!==null){F.updateSelection(H);F.close();F.clearSearch()}})}},clearSearch:function(){var F=this.getPlaceholder();if(F!==l&&this.getVal().length===0&&this.search.hasClass("select2-focused")===false){this.search.val(F).addClass("select2-default");this.resizeSearch()}else{this.search.val(" ").width(10)}},clearPlaceholder:function(){if(this.search.hasClass("select2-default")){this.search.val("").removeClass("select2-default")}else{if(this.search.val()===" "){this.search.val("")}}},opening:function(){this.parent.opening.apply(this,arguments);this.clearPlaceholder();this.resizeSearch();this.focusSearch()},close:function(){if(!this.opened()){return}this.parent.close.apply(this,arguments)},focus:function(){this.close();this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(I){var H=[],G=[],F=this;j(I).each(function(){if(b(F.id(this),H)<0){H.push(F.id(this));G.push(this)}});I=G;this.selection.find(".select2-search-choice").remove();j(I).each(function(){F.addSelectedChoice(this)});F.postprocessResults()},tokenize:function(){var F=this.search.val();F=this.opts.tokenizer(F,this.data(),this.bind(this.onSelect),this.opts);if(F!=null&&F!=l){this.search.val(F);if(F.length>0){this.open()}}},onSelect:function(F){this.addSelectedChoice(F);if(this.select||!this.opts.closeOnSelect){this.postprocessResults()}if(this.opts.closeOnSelect){this.close();this.search.width(10)}else{if(this.countSelectableResults()>0){this.search.width(10);this.resizeSearch();this.positionDropdown()}else{this.close()}}this.triggerChange({added:F});this.focusSearch()},cancel:function(){this.close();this.focusSearch()},addSelectedChoice:function(I){var G=!I.locked,M=j("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"),L=j("<li class='select2-search-choice select2-locked'><div></div></li>");var F=G?M:L,K=this.id(I),J=this.getVal(),H;H=this.opts.formatSelection(I,F.find("div"));if(H!=l){F.find("div").replaceWith("<div>"+this.opts.escapeMarkup(H)+"</div>")}if(G){F.find(".select2-search-choice-close").bind("mousedown",d).bind("click dblclick",this.bind(function(N){if(!this.enabled){return}j(N.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(j(N.target));this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");this.close();this.focusSearch()})).dequeue();d(N)})).bind("focus",this.bind(function(){if(!this.enabled){return}this.container.addClass("select2-container-active");this.dropdown.addClass("select2-drop-active")}))}F.data("select2-data",I);F.insertBefore(this.searchContainer);J.push(K);this.setVal(J)},unselect:function(G){var I=this.getVal(),H,F;G=G.closest(".select2-search-choice");if(G.length===0){throw"Invalid argument: "+G+". Must be .select2-search-choice"}H=G.data("select2-data");F=b(this.id(H),I);if(F>=0){I.splice(F,1);this.setVal(I);if(this.select){this.postprocessResults()}}G.remove();this.triggerChange({removed:H})},postprocessResults:function(){var H=this.getVal(),I=this.results.find(".select2-result-selectable"),G=this.results.find(".select2-result-with-children"),F=this;I.each2(function(K,J){var L=F.id(J.data("select2-data"));if(b(L,H)>=0){J.addClass("select2-disabled").removeClass("select2-result-selectable")}else{J.removeClass("select2-disabled").addClass("select2-result-selectable")}});G.each2(function(J,K){if(!K.is(".select2-result-selectable")&&K.find(".select2-result-selectable").length==0){K.addClass("select2-disabled")}else{K.removeClass("select2-disabled")}});if(this.highlight()==-1){I.each2(function(K,J){if(!J.hasClass("select2-disabled")&&J.hasClass("select2-result-selectable")){F.highlight(0);return false}})}},resizeSearch:function(){var K,I,H,F,G,J=n(this.search);K=x(this.search)+10;I=this.search.offset().left;H=this.selection.width();F=this.selection.offset().left;G=H-(I-F)-J;if(G<K){G=H-J}if(G<40){G=H-J}this.search.width(G)},getVal:function(){var F;if(this.select){F=this.select.val();return F===null?[]:F}else{F=this.opts.element.val();return m(F,this.opts.separator)}},setVal:function(G){var F;if(this.select){this.select.val(G)}else{F=[];j(G).each(function(){if(b(this,F)<0){F.push(this)}});this.opts.element.val(F.length===0?"":F.join(this.opts.separator))}},val:function(){var H,G=[],F=this;if(arguments.length===0){return this.getVal()}H=arguments[0];if(!H){this.opts.element.val("");this.updateSelection([]);this.clearSearch();return}this.setVal(H);if(this.select){this.select.find(":selected").each(function(){G.push({id:j(this).attr("value"),text:j(this).text()})});this.updateSelection(G)}else{if(this.opts.initSelection===l){throw new Error("val() cannot be called if initSelection() is not defined")}this.opts.initSelection(this.opts.element,function(J){var I=j(J).map(F.id);F.setVal(I);F.updateSelection(J);F.clearSearch()})}this.clearSearch()},onSortStart:function(){if(this.select){throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.")}this.search.width(0);this.searchContainer.hide()},onSortEnd:function(){var G=[],F=this;this.searchContainer.show();this.searchContainer.appendTo(this.searchContainer.parent());this.resizeSearch();this.selection.find(".select2-search-choice").each(function(){G.push(F.opts.id(j(this).data("select2-data")))});this.setVal(G);this.triggerChange()},data:function(G){var F=this,H;if(arguments.length===0){return this.selection.find(".select2-search-choice").map(function(){return j(this).data("select2-data")}).get()}else{if(!G){G=[]}H=j.map(G,function(I){return F.opts.id(I)});this.setVal(H);this.updateSelection(G);this.clearSearch()}}});j.fn.select2=function(){var I=Array.prototype.slice.call(arguments,0),J,H,K,G,F=["val","destroy","opened","open","close","focus","isFocused","container","onSortStart","onSortEnd","enable","disable","positionDropdown","data"];this.each(function(){if(I.length===0||typeof(I[0])==="object"){J=I.length===0?{}:j.extend({},I[0]);J.element=j(this);if(J.element.get(0).tagName.toLowerCase()==="select"){G=J.element.attr("multiple")}else{G=J.multiple||false;if("tags" in J){J.multiple=G=true}}H=G?new E():new v();H.init(J)}else{if(typeof(I[0])==="string"){if(b(I[0],F)<0){throw"Unknown method: "+I[0]}K=l;H=j(this).data("select2");if(H===l){return}if(I[0]==="container"){K=H.container}else{K=H[I[0]].apply(H,I.slice(1))}if(K!==l){return false}}else{throw"Invalid arguments to select2 plugin: "+I}}});return(K===l)?this:K};j.fn.select2.defaults={width:"copy",closeOnSelect:true,openOnEnter:true,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(F,G,I){var H=[];i(F.text,I.term,H);return H.join("")},formatSelection:function(G,F){return G?G.text:l},formatResultCssClass:function(F){return l},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(F,G){var H=G-F.length;return"Please enter "+H+" more character"+(H==1?"":"s")},formatSelectionTooBig:function(F){return"You can only select "+F+" item"+(F==1?"":"s")},formatLoadMore:function(F){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumSelectionSize:0,id:function(F){return F.id},matcher:function(F,G){return G.toUpperCase().indexOf(F.toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:y,escapeMarkup:function(F){if(F&&typeof(F)==="string"){return F.replace(/&/g,"&amp;")}return F},blurOnChange:false};window.Select2={query:{ajax:p,local:r,tags:o},util:{debounce:g,markMatch:i},"class":{"abstract":e,single:v,multi:E}}}(jQuery));
